# Maintainer: only_vip <onlyme_vip@protonmail.com>
# co-maintainer: zocker_160 <zocker1600 at posteo dot net>
pkgname="ungoogled-chromium-linchrome-bin"
_pkgname="ungoogled-chromium"
pkgver='100.0.4896.75.r972766'
__pkgver='100.0.4896.75-r972766'
_pkgver='100.0.4896.75_1'
pkgrel=2
arch=('amd64')
pkgdesc="Portable Chromium ungoogled (A lightweight approach to removing Google web service dependency) for 64-bit Linux prebuilt binary by macchrome"
url="https://github.com/macchrome/linchrome"
license=('BSD-3-clause')
provides=('chromium')
conflicts=('chromium')
options=(!strip)
source=("${_pkgname}-${_pkgver}.tar.xz::${url}/releases/download/v${__pkgver}-portable-ungoogled-Lin64/${_pkgname}_${_pkgver}.vaapi_linux.tar.xz"
        "ungoogled-chromium.desktop"
        "desktop-icon.patch")
sha512sums=('6cfa43509e01c273b1ae0a96e96c7da24514d45976e9e65b86da88d6eedeab16b790b04542459dbb0ea41bca47f64fc8523657ad8f84b41c5b2854da50e2dc87'
            '5ef6de325e3fdc363d4e7049b6f91e85b36c9d38a6c48da619314b172250e3e7d6a7fc4f1e29af9b9e86f8b4e51a72087deb79452fdb7083291f035ec6e61b68'
            '48439ea12897b6c1182704f3395948146497b43be8d3f746dd95292793172e2f7ba191edbbd6dacaff6291ec7abd920071ddb5b1ed9ca0531f1ed34d8c8a365b')

package() {
    install -d "${pkgdir}/opt/${_pkgname}" "${pkgdir}/usr/bin"
    install -Dm644 "${srcdir}/${_pkgname}.desktop" -t "${pkgdir}/usr/share/applications"
    install -Dm644 "${srcdir}/${_pkgname}_${_pkgver}.vaapi_linux/product_logo_48.png" "${pkgdir}/usr/share/icons/hicolor/48x48/apps/${_pkgname}.png"
    cp -vRf "${srcdir}/${_pkgname}_${_pkgver}.vaapi_linux/"* "${pkgdir}/opt/${_pkgname}/"
    install -Dm4755 "${srcdir}/${_pkgname}_${_pkgver}.vaapi_linux/chrome_sandbox" "${pkgdir}/opt/${_pkgname}/chrome-sandbox"
    chown root:root "${pkgdir}/opt/${_pkgname}/chrome-sandbox"
    ln -rs "${pkgdir}/opt/${_pkgname}/chrome-wrapper" "${pkgdir}/usr/bin/${_pkgname}"
    rm "${pkgdir}/opt/${_pkgname}/chrome_sandbox"
    patch -d "${pkgdir}" -p1 < "${srcdir}/desktop-icon.patch"
}
